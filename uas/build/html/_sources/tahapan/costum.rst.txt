*************
Costumization
*************

Cowrie
######

Cowrie merupakan contoh lain honeypot selain dionaea. Cowrie adalah SSH dan telnet honeypot high interaction yang dirancang untuk mencatat serangan brute force dan interaksi shell yang dilakukan oleh penyerang.

Penambahan honeyot cowrie pada server dapat divisisualisasikan juga bersamaan dengan honeypot dionaea. Caranya adalah dengan menambahkan konfigurasi logstash untuk cowrie:

::

   if [document_type] == "cowrie" {

                json {
                        source => "message"
                }

                if [remote_host]  {

                        mutate {
                                copy => { "remote_host" => "remote_hostname" }
                        }

                        dns {
                                reverse => [ "remote_hostname" ]
                                nameserver => [ "8.8.8.8", "8.8.4.4" ]
                                action => "replace"
                                hit_cache_size => 4096
                                hit_cache_ttl => 900
                                failed_cache_size => 512
                                failed_cache_ttl => 900
                        }

                        geoip {
                                source => "remote_host"
                                target => "geoip"
                        }
                }

                mutate {
                        remove_tag => [ "beats_input_codec_plain_applied"]
                        remove_field => [ "source", "offset", "input_type"]
                }
        }

   output {
        if [document_type] == "cowrie" {
                elasticsearch {
                        hosts => ["103.121.122.136:9200"]
                        index => "dionaea-%{+YYYY.MM.dd}"

Serta tambahkan konfigurasi filebeat sebagai berikut

::

   filebeat.prospectors:

   - type: log
     paths:
      - /home/cowrie/cowrie/var/log/cowrie/cowrie.json*
     fields:
       document_type: cowrie
     fields_under_root: true

   output:
    logstash:
     hosts: ["103.121.122.136:5044"]
     bulk_max_size: 2048

   logging.to_files: true
   logging.files:
    path: /var/log/filebeat/
    name: mybeat-vpn
    rotateeverybytes: 10485760 # = 10MB
    keepfiles: 7

Jika sudah buatlah index parsing baru pada kibana

.. image:: ../../images/index.jpg
    :width: 500px
    :align: center
    :height: 200px
    :alt: alternate text

Jika berhasil maka terdapat dua index yakni dionaea dan cowrie

.. image:: ../../images/index2.jpg
    :width: 500px
    :align: center
    :height: 300px
    :alt: alternate text

X-Pack
######

X-Pack merupakan fitur tambahan pada Elasticsearch yang menyediakan layanan keamanan, peringatan, pengawasan, pelaporan, machine learning, dan kemampuan lainnya. Pada Elasticsearch yang digunakan X-Pack standar telah terinstall secara otomatis, namun untuk memberikan layanan X-Pack yang lebih banyak dapat dilakukan instalasi X-Pack trial selama 30 hari. Pengaktifan layanan trial dengan memilih Menu Management > Elasticsearch > License Management > Start Trial.

.. image:: ../../images/xpack1.jpg
    :width: 500px
    :align: center
    :height: 200px
    :alt: alternate text

Keberhasilan aktivasi ditunjukkan dengan tampilan sebagai berikut :

.. image:: ../../images/xpack2.jpg
    :width: 500px
    :align: center
    :height: 200px
    :alt: alternate text

